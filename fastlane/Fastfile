lane :test do
  run_tests(
    project: "CD starter project.xcodeproj",
    scheme: "CD starter project",
    device: "iPhone 16",
    clean: true
  )
end

lane :ci_build do
  app_store_connect_api_key(
    key_id: ENV["API_KEY_ID"],
    issuer_id: ENV["API_ISSUER_ID"],
    key_filepath: "./AuthKey.p8"
  )
  
  build_app(
    scheme: "CD starter project",
    export_method: "app-store",       # or "ad-hoc", etc.
    export_options: {
      provisioningProfiles: {
        "com.othmanshahrouri.CD-starter-project" => ""    # leave empty for automatic
      }
    }
  )
end
